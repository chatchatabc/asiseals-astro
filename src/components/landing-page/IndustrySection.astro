---
import industriesJson from "@data/industries.json";
import { register } from "swiper/element/bundle";
import { Icon } from "astro-icon";

register();
---

<industry-section>
  <!-- Header -->
  <header
    class="flex justify-between items-center max-w-7xl mx-auto px-4 lg:px-8"
  >
    <h1 class="text-5xl">Industry</h1>
    <div class="flex items-center divide-x">
      <button id="prev-btn" class="px-2">
        <Icon
          name="mdi:chevron-left"
          class="h-8 w-8 transition hover:text-primary"
        />
      </button>
      <button id="next-btn" class="px-2">
        <Icon
          name="mdi:chevron-right"
          class="h-8 w-8 transition hover:text-primary"
        />
      </button>
    </div>
  </header>

  <!-- Container -->
  <section class="swiper max-w-7xl mx-auto px-4 mt-6">
    <!-- Carousel -->
    <swiper-container class="pb-16">
      {
        industriesJson.contents.map((item) => {
          return (
            <swiper-slide class="p-4">
              <figure class="relative group">
                <div class="bg-white py-16 w-full h-56 px-8">
                  <a
                    href={`/industries/${item.slug}`}
                    class="absolute w-full left-0 top-0 h-full z-[1]"
                  />
                  <img
                    src={item.image}
                    alt={item.name}
                    class="duration-500 w-full h-full object-contain group-hover:opacity-0"
                  />
                </div>
                <figcaption class="duration-500 absolute w-full h-fit left-0 bottom-0 translate-y-full pointer-events-none group-hover:pointer-events-auto group-hover:bottom-1/2 group-hover:translate-y-1/2">
                  <p class="text-center duration-500 text-xl tracking-widest px-8 group-hover:tracking-[0.5rem]">
                    <span class="transition group-hover:text-primary">
                      {item.name}
                    </span>
                  </p>
                </figcaption>
              </figure>
            </swiper-slide>
          );
        })
      }
    </swiper-container>
  </section>

  <!-- Action button -->
  <a
    href="/industries"
    class="block w-fit py-4 px-6 mx-auto text-xl bg-primary"
  >
    View More Industries &gt;
  </a>
</industry-section>

<script>
  class IndustrySection extends HTMLElement {
    constructor() {
      super();

      const swiperEl = this.querySelector<any>("swiper-container");

      const swiperParams = {
        speed: 500,
        loop: true,
        navigation: {
          prevEl: "#prev-btn",
          nextEl: "#next-btn",
        },
        slidesPerView: 1,
        breakpoints: {
          768: {
            slidesPerView: 3,
          },
          1024: {
            slidesPerView: 4,
          },
        },
        on: {
          init() {
            // ...
          },
        },
      };

      // now we need to assign all parameters to Swiper element
      Object.assign(swiperEl, swiperParams);

      // and now initialize it
      swiperEl.initialize();
    }
  }

  customElements.define("industry-section", IndustrySection);
</script>
