---
import ProductSearch from "@components/widgets/ProductSearch.astro";
import ProductsList from "@components/widgets/ProductsList.svelte";
import productCategoriesJson from "@data/product-categories.json";
import LayoutCategory from "@layouts/LayoutCategory.astro";
import type { InferGetStaticPropsType } from "astro";

export async function getStaticPaths() {
  return productCategoriesJson.contents.map((category) => {
    return {
      params: { category: category.slug },
      props: { category },
    };
  });
}

type Props = InferGetStaticPropsType<typeof getStaticPaths>;

const { category } = Astro.props as Props;
---

<LayoutCategory
  image="/images/products/banner-inner.webp"
  pageTitle={category.pageTitle ?? category.name}
  title={category.name}
  pageDescription={category.pageDescription}
  pageKeywords={category.pageKeywords}
  ogDescription={category.ogDescription ?? category.pageDescription}
  ogImage={category.ogImage}
  ogTitle={category.ogTitle ?? category.name ?? category.pageTitle}
  ogType={category.ogType}
  twitterCardType={category.twitterCardType}
  twitterTitle={category.twitterTitle}
  twitterDescription={category.twitterDescription}
  twitterImage={category.twitterImage}
>
  <!-- Container -->
  <section class="max-w-7xl mx-auto px-4 lg:px-8">
    <section class="py-8 border-b-2 border-dashed">
      <ProductSearch />
    </section>

    <!-- Sub-category items -->
    <section class="my-8">
      <ProductsList
        filterType="category"
        filterValue={category.slug}
        client:idle
      />
    </section>
  </section>
</LayoutCategory>
